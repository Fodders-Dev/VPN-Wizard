<!doctype html>
<html lang="ru">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VPN Wizard</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <main class="app">
    <header class="hero">
      <div class="hero-top">
        <div class="title" data-i18n="app_title">VPN Wizard</div>
        <div class="hero-actions">
          <button type="button" class="ghost" id="tour-btn" data-i18n="tour_btn">Обучение</button>
          <button type="button" class="ghost" id="faq-btn" data-i18n="faq_btn">FAQ</button>
          <div class="lang-toggle" role="group" aria-label="Language">
            <button type="button" class="lang-btn" data-lang="ru">RU</button>
            <button type="button" class="lang-btn" data-lang="en">EN</button>
          </div>
        </div>
      </div>
      <div class="subtitle" data-i18n="app_subtitle">Простая настройка AmneziaWG VPN на вашем сервере</div>
    </header>

    <section class="card">
      <h2 data-i18n="step1_title">Шаг 1. Доступ к серверу</h2>
      <form id="provision-form">
        <label>
          <span data-i18n="server_host_label">IP или хост сервера</span>
          <input name="host" placeholder="1.2.3.4" data-i18n-placeholder="server_host_placeholder" required />
        </label>
        <label>
          <span data-i18n="ssh_user_label">SSH пользователь</span>
          <input name="user" placeholder="root" data-i18n-placeholder="ssh_user_placeholder" required />
        </label>
        <label>
          <span data-i18n="ssh_password_label">SSH пароль</span>
          <input name="password" type="password" placeholder="optional if key" data-i18n-placeholder="ssh_password_placeholder" />
        </label>
        <label class="profile-only hidden">
          <span data-i18n="client_name_label">Имя профиля (необязательно)</span>
          <input name="client_name" placeholder="grandma-phone" data-i18n-placeholder="client_name_placeholder" />
          <small class="field-hint" data-i18n="profile_name_hint">
            Нужно, чтобы разные устройства получали разные названия конфигов.
          </small>
        </label>
        <label class="advanced">
          <span data-i18n="ssh_key_label">SSH ключ (необязательно)</span>
          <textarea name="key_content" placeholder="paste private key" data-i18n-placeholder="ssh_key_placeholder"></textarea>
        </label>
        <label class="advanced">
          <span data-i18n="udp_port_label">UDP порт сервера</span>
          <input name="listen_port" type="number" min="1" max="65535" value="3478" />
        </label>
        <div class="advanced safe-row">
          <label class="toggle">
            <input type="checkbox" id="safe-toggle" />
            <span data-i18n="safe_mode_label">Безопасный режим (только проверка)</span>
          </label>
          <small class="field-hint" data-i18n="safe_mode_hint">
            Показывает, что изменится, без установки.
          </small>
        </div>
        <div class="server-tools">
          <button type="submit" id="check-server-btn" data-i18n="check_server_btn">Проверить сервер</button>
          <div id="server-status" class="server-status" data-i18n="server_status_idle">Сервер не проверен</div>
          <div id="server-meta" class="server-meta"></div>
          <div id="server-advice" class="server-advice" data-i18n="server_advice">
            Если сервер пустой — можно смело настраивать. Если нет — прочитайте FAQ и включите расширенные настройки.
          </div>
          <label class="toggle hidden" id="reconfigure-toggle">
            <input type="checkbox" id="reconfigure-checkbox" />
            <span data-i18n="reconfigure_label">Показать настройку сервера</span>
          </label>
        </div>
        <div class="toggle-row">
          <label class="toggle">
            <input type="checkbox" id="simple-toggle" checked />
            <span data-i18n="simple_mode_label">Простой режим</span>
          </label>
          <span class="toggle-hint" data-i18n="simple_mode_hint">Скрыть расширенные поля</span>
        </div>
        <button type="button" id="provision-btn" class="hidden" data-i18n="provision_btn">Настроить сервер и получить первый профиль</button>
        <button type="button" id="add-client-btn" class="secondary hidden" data-i18n="add_client_btn">Добавить профиль</button>
      </form>
    </section>

    <section class="card hidden" id="servers-card">
      <h2 data-i18n="servers_title">Мои серверы</h2>
      <div id="servers-empty" data-i18n="servers_empty">Пока нет сохранённых серверов.</div>
      <div id="servers-list" class="servers-list"></div>
    </section>

    <section class="card hidden" id="progress-card">
      <h2 data-i18n="step2_title">Шаг 2. Прогресс</h2>
      <div class="progress-bar" aria-hidden="true">
        <div id="progress-fill" class="progress-fill"></div>
      </div>
      <div class="spinner" aria-hidden="true"></div>
      <div id="status" data-i18n="status_waiting">Ожидание...</div>
      <button type="button" id="toggle-log-btn" class="secondary" data-i18n="toggle_log_btn">Показать лог</button>
      <div id="progress-log" class="log hidden"></div>
    </section>

    <section class="card hidden" id="clients-card">
      <h2 data-i18n="clients_title">Профили</h2>
      <div id="clients-empty" data-i18n="clients_empty">Профили не найдены.</div>
      <div id="clients-list" class="clients-list"></div>
    </section>

    <section class="card hidden" id="result-card">
      <h2 data-i18n="step3_title">Шаг 3. Скачать</h2>
      <a id="download-link" class="download" href="#" download="client1.conf" data-i18n="download_btn">Скачать конфиг</a>
      <a id="qr-download" class="secondary qr-download hidden" href="#" download="client1.png" data-i18n="download_qr_btn">Скачать QR</a>
      <img id="qr-image" alt="QR code" />
    </section>

  </main>

  <div class="modal hidden" id="faq-modal" aria-hidden="true">
    <div class="modal-backdrop" data-modal-close></div>
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-header">
        <h3 data-i18n="faq_title">FAQ</h3>
        <button type="button" class="ghost" data-modal-close>✕</button>
      </div>
      <div id="faq-content" class="modal-body"></div>
    </div>
  </div>

  <div class="modal hidden tour-modal" id="tour-modal" aria-hidden="true">
    <div class="modal-backdrop" data-modal-close></div>
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-header">
        <h3 data-i18n="tour_title">Обучение</h3>
        <button type="button" class="ghost" data-modal-close>✕</button>
      </div>
      <div class="modal-body">
        <div class="tour-step-title" id="tour-step-title"></div>
        <div class="tour-step-body" id="tour-step-body"></div>
      </div>
      <div class="modal-actions">
        <button type="button" class="secondary" id="tour-prev" data-i18n="tour_prev">Назад</button>
        <button type="button" id="tour-next" data-i18n="tour_next">Далее</button>
      </div>
    </div>
  </div>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>

</html>
